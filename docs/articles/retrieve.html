<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Retrieve data via OxCGRT API • oxcgrt</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Retrieve data via OxCGRT API">
<meta property="og:description" content="oxcgrt">
<meta property="og:image" content="https://como-ph.github.io/oxcgrt/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-8QC97H7XRC"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-8QC97H7XRC');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">oxcgrt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/retrieve.html">Retrieve data via OxCGRT API</a>
    </li>
    <li>
      <a href="../articles/calculate.html">Calculate OxCGRT sub-indices and indices</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/como-ph/oxcgrt/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="retrieve_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="retrieve_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="retrieve_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Retrieve data via OxCGRT API</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/como-ph/oxcgrt/blob/master/vignettes/retrieve.Rmd"><code>vignettes/retrieve.Rmd</code></a></small>
      <div class="hidden name"><code>retrieve.Rmd</code></div>

    </div>

    
    
<p>The <em>retrieve data</em> functions are based on the <a href="https://www.bsg.ox.ac.uk/research/research-projects/coronavirus-government-response-tracker">OxCGRT</a>’s JSON API described <a href="https://covidtrackerapi.bsg.ox.ac.uk">here</a>. Two API endpoints are provided: 1) endpoint for JSON providing data for stringency index by country over time; and, 2) endpoint for JSON providing data on policy actions and stringency index for a specific country on a specific day.</p>
<div id="stringency-index-by-country-over-time" class="section level2">
<h2 class="hasAnchor">
<a href="#stringency-index-by-country-over-time" class="anchor"></a>Stringency index by country over time</h2>
<p>The first API endpoint provides JSON for all countries included in the <a href="https://www.bsg.ox.ac.uk/research/research-projects/coronavirus-government-response-tracker">OxCGRT</a> over a specified period of time:</p>
<p><br></p>
<p><code>https://covidtrackerapi.bsg.ox.ac.uk/api/v2/stringency/date-range/{start-date}/{end-date}</code></p>
<p><br></p>
<p>where <code>start-date</code> and <code>end-date</code> are the starting date and ending date (both in <code>YYYY-MM-DD</code> format) respectively from which to retrieve data.</p>
<p>The <code>oxcgrt</code> package provides a function named <code>get_json_time</code> to interface with the API and retrieve the specified JSON and a function named <code>get_data_time</code> to extract the data from the specified JSON into an <a href="https://cran.r-project.org">R</a> <code>tibble</code> object. These two functions have been designed such that they can be piped from one to the other. Hence to retrieve stringency index data for all countries from 1 June 2020 to current date, the following code can be used:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_json_time.html">get_json_time</a></span><span class="op">(</span>from <span class="op">=</span> <span class="st">"2020-06-01"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/get_data_time.html">get_data_time</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>This produces the following output:</p>
<pre><code>#&gt; # A tibble: 30,646 x 9
#&gt;    date_value country_code country_name confirmed deaths stringency_actu…
#&gt;    &lt;date&gt;     &lt;chr&gt;        &lt;chr&gt;            &lt;int&gt;  &lt;int&gt;            &lt;dbl&gt;
#&gt;  1 2020-06-01 ABW          Aruba              101      3             50  
#&gt;  2 2020-06-01 AFG          Afghanistan      15205    257             84.3
#&gt;  3 2020-06-01 AGO          Angola              86      4             77.8
#&gt;  4 2020-06-01 ALB          Albania           1137     33             71.3
#&gt;  5 2020-06-01 AND          Andorra            764     51             50  
#&gt;  6 2020-06-01 ARE          United Arab…     34557    264             72.2
#&gt;  7 2020-06-01 ARG          Argentina        16838    539             90.7
#&gt;  8 2020-06-01 AUS          Australia         7195    102             62.0
#&gt;  9 2020-06-01 AUT          Austria          16642    668             53.7
#&gt; 10 2020-06-01 AZE          Azerbaijan        5494     63             77.8
#&gt; # … with 30,636 more rows, and 3 more variables: stringency &lt;dbl&gt;,
#&gt; #   stringency_legacy &lt;dbl&gt;, stringency_legacy_disp &lt;dbl&gt;</code></pre>
<p>Important to note that in <code>get_json_time</code>, only the starting date (using the <code>from</code> argument) is specified to the desired 1 June 2020 in <code>YYYY-MM-DD</code> format. This is because by default the <code>to</code> argument (for the ending date) is set to the current date using a call to the <code><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date()</a></code> function. By default, the <code>from</code> argument is set to 2 January 2020 (2020-01-02) which is the earliest available data point for the stringency index. Therefore, to retrieve data on stringency index for all countries for all available time points up to current, the following commands can be issued:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_json_time.html">get_json_time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/get_data_time.html">get_data_time</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>which produces the following output:</p>
<pre><code>#&gt; # A tibble: 57,481 x 9
#&gt;    date_value country_code country_name stringency_actu… stringency
#&gt;    &lt;date&gt;     &lt;chr&gt;        &lt;chr&gt;                   &lt;dbl&gt;      &lt;dbl&gt;
#&gt;  1 2020-01-02 ABW          Aruba                       0          0
#&gt;  2 2020-01-02 AFG          Afghanistan                 0          0
#&gt;  3 2020-01-02 AGO          Angola                      0          0
#&gt;  4 2020-01-02 ALB          Albania                     0          0
#&gt;  5 2020-01-02 AND          Andorra                     0          0
#&gt;  6 2020-01-02 ARE          United Arab…                0          0
#&gt;  7 2020-01-02 ARG          Argentina                   0          0
#&gt;  8 2020-01-02 AUS          Australia                   0          0
#&gt;  9 2020-01-02 AUT          Austria                     0          0
#&gt; 10 2020-01-02 AZE          Azerbaijan                  0          0
#&gt; # … with 57,471 more rows, and 4 more variables: stringency_legacy &lt;dbl&gt;,
#&gt; #   stringency_legacy_disp &lt;dbl&gt;, confirmed &lt;int&gt;, deaths &lt;int&gt;</code></pre>
<div id="policy-actions-and-stringency-index-for-specific-country-on-a-specific-day" class="section level4">
<h4 class="hasAnchor">
<a href="#policy-actions-and-stringency-index-for-specific-country-on-a-specific-day" class="anchor"></a>Policy actions and stringency index for specific country on a specific day</h4>
<p>The second API endpoint provides JSON for a specific country included in the <a href="https://www.bsg.ox.ac.uk/research/research-projects/coronavirus-government-response-tracker">OxCGRT</a> for a specified day:</p>
<p><br></p>
<p><code>https://covidtrackerapi.bsg.ox.ac.uk/api/v2/stringency/actions/{country-code}/{date}</code></p>
<p><br></p>
<p>where <code>country-code</code> is the ISO 3166-1 alpha-3 country code for the required country to get data for and <code>date</code> is the date (in <code>YYYY-MM-DD</code> format) on which to retrieve data.</p>
<p>The <code>oxcgrt</code> package provides a function named <code>get_json_actions</code> to interface with the API and retrieve the specified JSON and a function named <code>get_data</code> to extract the data from the specified JSON into a named <code>list</code> <a href="https://cran.r-project.org">R</a> object. These two functions have been designed such that they can be piped from one to the other. Hence to retrieve policy actions and stringency index data for Afghanistan for 1 June 2020, the following code can be used:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_json_time.html">get_json_actions</a></span><span class="op">(</span>ccode <span class="op">=</span> <span class="st">"AFG"</span>, 
                 from <span class="op">=</span> <span class="cn">NULL</span>, 
                 to <span class="op">=</span> <span class="st">"2020-06-01"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/get_data.html">get_data</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>which produces the following output:</p>
<pre><code>#&gt; $policyActions
#&gt; # A tibble: 18 x 9
#&gt;    policy_type_code policy_type_dis… policyvalue policyvalue_act… flagged
#&gt;    &lt;chr&gt;            &lt;chr&gt;                  &lt;int&gt;            &lt;int&gt; &lt;lgl&gt;  
#&gt;  1 C1               School closing             3                3 TRUE   
#&gt;  2 C2               Workplace closi…           3                3 FALSE  
#&gt;  3 C3               Cancel public e…           2                2 TRUE   
#&gt;  4 C4               Restrictions on…           4                4 TRUE   
#&gt;  5 C5               Close public tr…           2                2 FALSE  
#&gt;  6 C6               Stay at home re…           2                2 FALSE  
#&gt;  7 C7               Restrictions on…           2                2 FALSE  
#&gt;  8 C8               International t…           3                3 NA     
#&gt;  9 E1               Income support             0                0 NA     
#&gt; 10 E2               Debt/contract r…           0                0 NA     
#&gt; 11 E3               Fiscal measures            0                0 NA     
#&gt; 12 E4               International s…           0                0 NA     
#&gt; 13 H1               Public informat…           2                2 TRUE   
#&gt; 14 H2               Testing policy             1                1 NA     
#&gt; 15 H3               Contact tracing            1                1 NA     
#&gt; 16 H4               Emergency inves…           0                0 NA     
#&gt; 17 H5               Investment in v…           0                0 NA     
#&gt; 18 H6               Facial Coverings           1                1 TRUE   
#&gt; # … with 4 more variables: is_general &lt;lgl&gt;, notes &lt;chr&gt;,
#&gt; #   flag_value_display_field &lt;chr&gt;, policy_value_display_field &lt;chr&gt;
#&gt; 
#&gt; $stringencyData
#&gt; # A tibble: 1 x 6
#&gt;   date_value country_code confirmed deaths stringency_actual stringency
#&gt;   &lt;chr&gt;      &lt;chr&gt;            &lt;int&gt;  &lt;int&gt;             &lt;dbl&gt;      &lt;dbl&gt;
#&gt; 1 2020-06-01 AFG              15205    257              84.3       84.3</code></pre>
<p>Important to note that the output is a named <code>list</code> object containing a <code>tibble</code> of <strong>policy actions</strong> data and a <code>tibble</code> of <strong>stringency index</strong> data for the specified country and the specified date.</p>
</div>
<div id="policy-actions-for-specific-country-or-countries-on-a-specific-day-or-days" class="section level4">
<h4 class="hasAnchor">
<a href="#policy-actions-for-specific-country-or-countries-on-a-specific-day-or-days" class="anchor"></a>Policy actions for specific country or countries on a specific day or days</h4>
<p>It is also possible to retrieve just policy actions data for a specific country or for multiple countries on a specific day or multiple days. To retrieve policy actions data for Afghanistan for 1 June 2020, the following code can be used:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_json_time.html">get_json_actions</a></span><span class="op">(</span>ccode <span class="op">=</span> <span class="st">"AFG"</span>, 
                 from <span class="op">=</span> <span class="cn">NULL</span>, 
                 to <span class="op">=</span> <span class="st">"2020-06-01"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/get_data_action.html">get_data_action</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>This results in:</p>
<pre><code>#&gt; # A tibble: 18 x 12
#&gt;    date_value country_code country_name policy_type_code policy_type_dis…
#&gt;    &lt;date&gt;     &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;            &lt;chr&gt;           
#&gt;  1 2020-06-01 AFG          Afghanistan  C1               School closing  
#&gt;  2 2020-06-01 AFG          Afghanistan  C2               Workplace closi…
#&gt;  3 2020-06-01 AFG          Afghanistan  C3               Cancel public e…
#&gt;  4 2020-06-01 AFG          Afghanistan  C4               Restrictions on…
#&gt;  5 2020-06-01 AFG          Afghanistan  C5               Close public tr…
#&gt;  6 2020-06-01 AFG          Afghanistan  C6               Stay at home re…
#&gt;  7 2020-06-01 AFG          Afghanistan  C7               Restrictions on…
#&gt;  8 2020-06-01 AFG          Afghanistan  C8               International t…
#&gt;  9 2020-06-01 AFG          Afghanistan  E1               Income support  
#&gt; 10 2020-06-01 AFG          Afghanistan  E2               Debt/contract r…
#&gt; 11 2020-06-01 AFG          Afghanistan  E3               Fiscal measures 
#&gt; 12 2020-06-01 AFG          Afghanistan  E4               International s…
#&gt; 13 2020-06-01 AFG          Afghanistan  H1               Public informat…
#&gt; 14 2020-06-01 AFG          Afghanistan  H2               Testing policy  
#&gt; 15 2020-06-01 AFG          Afghanistan  H3               Contact tracing 
#&gt; 16 2020-06-01 AFG          Afghanistan  H4               Emergency inves…
#&gt; 17 2020-06-01 AFG          Afghanistan  H5               Investment in v…
#&gt; 18 2020-06-01 AFG          Afghanistan  H6               Facial Coverings
#&gt; # … with 7 more variables: policyvalue &lt;int&gt;, policyvalue_actual &lt;int&gt;,
#&gt; #   flagged &lt;lgl&gt;, is_general &lt;lgl&gt;, notes &lt;chr&gt;,
#&gt; #   flag_value_display_field &lt;chr&gt;, policy_value_display_field &lt;chr&gt;</code></pre>
<p>Important to note here that the output is a tibble of just the policy actions and three additional columns have been added to the dataset - <code>date_value</code>, <code>country_code</code>, and <code>country_name</code> - to identify the data as coming from a specific date and for a specific country.</p>
<p>To retrieve policy actions data for multiple countries on multiple days, the <code>get_data_actions</code> functions can be used as shown below:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_json_time.html">get_json_actions</a></span><span class="op">(</span>ccode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AFG"</span>, <span class="st">"Philippines"</span><span class="op">)</span>, 
                 from <span class="op">=</span> <span class="st">"2020-10-25"</span>, 
                 to <span class="op">=</span> <span class="st">"2020-10-31"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/get_data_action.html">get_data_actions</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>This results in:</p>
<pre><code>#&gt; # A tibble: 252 x 12
#&gt;    date_value country_code country_name policy_type_code policy_type_dis…
#&gt;    &lt;date&gt;     &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;            &lt;chr&gt;           
#&gt;  1 2020-10-25 AFG          Afghanistan  C1               School closing  
#&gt;  2 2020-10-25 AFG          Afghanistan  C2               Workplace closi…
#&gt;  3 2020-10-25 AFG          Afghanistan  C3               Cancel public e…
#&gt;  4 2020-10-25 AFG          Afghanistan  C4               Restrictions on…
#&gt;  5 2020-10-25 AFG          Afghanistan  C5               Close public tr…
#&gt;  6 2020-10-25 AFG          Afghanistan  C6               Stay at home re…
#&gt;  7 2020-10-25 AFG          Afghanistan  C7               Restrictions on…
#&gt;  8 2020-10-25 AFG          Afghanistan  C8               International t…
#&gt;  9 2020-10-25 AFG          Afghanistan  E1               Income support  
#&gt; 10 2020-10-25 AFG          Afghanistan  E2               Debt/contract r…
#&gt; # … with 242 more rows, and 7 more variables: policyvalue &lt;int&gt;,
#&gt; #   policyvalue_actual &lt;int&gt;, flagged &lt;lgl&gt;, is_general &lt;lgl&gt;, notes &lt;chr&gt;,
#&gt; #   flag_value_display_field &lt;chr&gt;, policy_value_display_field &lt;chr&gt;</code></pre>
<p>Important to note here that the output is a tibble of just the policy actions and three additional columns have been added to the dataset - <code>date_value</code>, <code>country_code</code>, and <code>country_name</code> - to identify the data as coming from a specific date and for a specific country.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Ernest Guevarra.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
